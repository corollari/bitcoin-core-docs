<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>fuzzing</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="pandoc.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <link rel='shortcut icon' href='favicon.png' />
</head>
<body>
<h1 id="fuzzing-bitcoin-core-using-libfuzzer">Fuzzing Bitcoin Core using libFuzzer</h1>
<h2 id="quickstart-guide">Quickstart guide</h2>
<p>To quickly get started fuzzing Bitcoin Core using <a href="https://llvm.org/docs/LibFuzzer.html">libFuzzer</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1">$ <span class="fu">git</span> clone https://github.com/bitcoin/bitcoin</a>
<a class="sourceLine" id="cb1-2" title="2">$ <span class="bu">cd</span> bitcoin/</a>
<a class="sourceLine" id="cb1-3" title="3">$ <span class="ex">./autogen.sh</span></a>
<a class="sourceLine" id="cb1-4" title="4">$ <span class="va">CC=</span>clang <span class="va">CXX=</span>clang++ <span class="ex">./configure</span> --enable-fuzz --with-sanitizers=address,fuzzer,undefined</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="co"># macOS users: If you have problem with this step then make sure to read &quot;macOS hints for</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="co"># libFuzzer&quot; on https://github.com/bitcoin/bitcoin/blob/master/doc/fuzzing.html#macos-hints-for-libfuzzer</span></a>
<a class="sourceLine" id="cb1-7" title="7">$ <span class="fu">make</span></a>
<a class="sourceLine" id="cb1-8" title="8">$ <span class="ex">src/test/fuzz/process_message</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co"># abort fuzzing using ctrl-c</span></a></code></pre></div>
<h2 id="fuzzing-harnesses-fuzzing-output-and-fuzzing-corpora">Fuzzing harnesses, fuzzing output and fuzzing corpora</h2>
<p><a href="https://github.com/bitcoin/bitcoin/blob/master/src/test/fuzz/process_message.cpp"><code>process_message</code></a> is a fuzzing harness for the <a href="https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp"><code>ProcessMessage(...)</code> function (<code>net_processing</code>)</a>. The available fuzzing harnesses are found in <a href="https://github.com/bitcoin/bitcoin/tree/master/src/test/fuzz"><code>src/test/fuzz/</code></a>.</p>
<p>The fuzzer will output <code>NEW</code> every time it has created a test input that covers new areas of the code under test. For more information on how to interpret the fuzzer output, see the <a href="https://llvm.org/docs/LibFuzzer.html">libFuzzer documentation</a>.</p>
<p>If you specify a corpus directory then any new coverage increasing inputs will be saved there:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1">$ <span class="fu">mkdir</span> -p process_message-seeded-from-thin-air/</a>
<a class="sourceLine" id="cb2-2" title="2">$ <span class="ex">src/test/fuzz/process_message</span> process_message-seeded-from-thin-air/</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="ex">INFO</span>: Seed: 840522292</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="ex">INFO</span>: Loaded 1 modules   (424174 inline 8-bit counters)<span class="bu">:</span> 424174 [0x55e121ef9ab8, 0x55e121f613a6),</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="ex">INFO</span>: Loaded 1 PC tables (424174 PCs)<span class="bu">:</span> 424174 [0x55e121f613a8,0x55e1225da288),</a>
<a class="sourceLine" id="cb2-6" title="6"><span class="ex">INFO</span>:        0 files found in process_message-seeded-from-thin-air/</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="ex">INFO</span>: -max_len is not provided<span class="kw">;</span> <span class="ex">libFuzzer</span> will not generate inputs larger than 4096 bytes</a>
<a class="sourceLine" id="cb2-8" title="8"><span class="ex">INFO</span>: A corpus is not provided, starting from an empty corpus</a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#2      INITED cov: 94 ft: 95 corp: 1/1b exec/s: 0 rss: 150Mb</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#3      NEW    cov: 95 ft: 96 corp: 2/3b lim: 4 exec/s: 0 rss: 150Mb L: 2/2 MS: 1 InsertByte-</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#4      NEW    cov: 96 ft: 98 corp: 3/7b lim: 4 exec/s: 0 rss: 150Mb L: 4/4 MS: 1 CrossOver-</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co">#21     NEW    cov: 96 ft: 100 corp: 4/11b lim: 4 exec/s: 0 rss: 150Mb L: 4/4 MS: 2 ChangeBit-CrossOver-</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co">#324    NEW    cov: 101 ft: 105 corp: 5/12b lim: 6 exec/s: 0 rss: 150Mb L: 6/6 MS: 5 CrossOver-ChangeBit-CopyPart-ChangeBit-ChangeBinInt-</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#1239   REDUCE cov: 102 ft: 106 corp: 6/24b lim: 14 exec/s: 0 rss: 150Mb L: 13/13 MS: 5 ChangeBit-CrossOver-EraseBytes-ChangeBit-InsertRepeatedBytes-</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#1272   REDUCE cov: 102 ft: 106 corp: 6/23b lim: 14 exec/s: 0 rss: 150Mb L: 12/12 MS: 3 ChangeBinInt-ChangeBit-EraseBytes-</span></a>
<a class="sourceLine" id="cb2-16" title="16">        <span class="ex">NEW_FUNC</span>[1/677]: 0x55e11f456690 in std::_Function_base::~_Function_base() <span class="ex">/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits</span>/std_function.h:<span class="ex">255</span></a>
<a class="sourceLine" id="cb2-17" title="17">        <span class="ex">NEW_FUNC</span>[2/677]: 0x55e11f465800 in CDataStream::CDataStream(std::vector<span class="op">&lt;</span>unsigned char, std::allocator<span class="op">&lt;</span>unsigned char<span class="op">&gt;</span> <span class="op">&gt;</span> const<span class="kw">&amp;</span>, <span class="ex">int</span>, int) <span class="ex">src/.</span>/streams.h:<span class="ex">248</span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#2125   REDUCE cov: 4820 ft: 4867 corp: 7/29b lim: 21 exec/s: 0 rss: 155Mb L: 6/12 MS: 2 CopyPart-CMP- DE: &quot;block&quot;-</span></a>
<a class="sourceLine" id="cb2-19" title="19">        <span class="ex">NEW_FUNC</span>[1/9]: 0x55e11f64d790 in std::_Rb_tree<span class="op">&lt;</span>uint256, std::pair<span class="op">&lt;</span>uint256 const, std::chrono::duration<span class="op">&lt;</span>long, std::ratio<span class="op">&lt;</span>1l, 1000000l<span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span>, std::_Select1st<span class="op">&lt;</span>std::pair<span class="op">&lt;</span>uint256 const, std::chrono::duration<span class="op">&lt;</span>long, std::ratio<span class="op">&lt;</span>1l, 1000000l<span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span>, std::less<span class="op">&lt;</span>uint256<span class="op">&gt;</span>, std::allocator<span class="op">&lt;</span>std::pair<span class="op">&lt;</span>uint256 const, std::chrono::duration<span class="op">&lt;</span>long, std::ratio<span class="op">&lt;</span>1l, 1000000l<span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span>::~_Rb_tree() <span class="ex">/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits</span>/stl_tree.h:<span class="ex">972</span></a>
<a class="sourceLine" id="cb2-20" title="20">        <span class="ex">NEW_FUNC</span>[2/9]: 0x55e11f64d870 in std::_Rb_tree<span class="op">&lt;</span>uint256, std::pair<span class="op">&lt;</span>uint256 const, std::chrono::duration<span class="op">&lt;</span>long, std::ratio<span class="op">&lt;</span>1l, 1000000l<span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span>, std::_Select1st<span class="op">&lt;</span>std::pair<span class="op">&lt;</span>uint256 const, std::chrono::duration<span class="op">&lt;</span>long, std::ratio<span class="op">&lt;</span>1l, 1000000l<span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span>, std::less<span class="op">&lt;</span>uint256<span class="op">&gt;</span>, std::allocator<span class="op">&lt;</span>std::pair<span class="op">&lt;</span>uint256 const, std::chrono::duration<span class="op">&lt;</span>long, std::ratio<span class="op">&lt;</span>1l, 1000000l<span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span>::_M_erase(std::_Rb_tree_node<span class="op">&lt;</span>std::pair<span class="op">&lt;</span>uint256 const, std::chrono::duration<span class="op">&lt;</span>long, std::ratio<span class="op">&lt;</span>1l, 1000000l<span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span> <span class="op">&gt;</span>*) <span class="ex">/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits</span>/stl_tree.h:<span class="ex">1875</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="co">#2228   NEW    cov: 4898 ft: 4971 corp: 8/35b lim: 21 exec/s: 0 rss: 156Mb L: 6/12 MS: 3 EraseBytes-CopyPart-PersAutoDict- DE: &quot;block&quot;-</span></a>
<a class="sourceLine" id="cb2-22" title="22">        <span class="ex">NEW_FUNC</span>[1/5]: 0x55e11f46df70 in std::enable_if<span class="op">&lt;</span>__and_<span class="op">&lt;</span>std::allocator_traits<span class="op">&lt;</span>zero_after_free_allocator<span class="op">&lt;</span>char<span class="op">&gt;</span> <span class="op">&gt;</span>::__construct_helper<span class="op">&lt;</span>char, unsigned char const<span class="op">&amp;&gt;</span>::type<span class="op">&gt;</span>::value, void<span class="op">&gt;</span>::type std::allocator_traits<span class="op">&lt;</span>zero_after_free_allocator<span class="op">&lt;</span>char<span class="op">&gt;</span> <span class="op">&gt;</span>::_S_construct<span class="op">&lt;</span>char, unsigned char const<span class="op">&amp;&gt;</span>(zero_after_free_allocator<span class="op">&lt;</span>char<span class="op">&gt;</span><span class="kw">&amp;</span>, <span class="ex">char*</span>, unsigned char const<span class="kw">&amp;</span>) <span class="ex">/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits</span>/alloc_traits.h:<span class="ex">243</span></a>
<a class="sourceLine" id="cb2-23" title="23">        <span class="ex">NEW_FUNC</span>[2/5]: 0x55e11f477390 in std::vector<span class="op">&lt;</span>unsigned char, std::allocator<span class="op">&lt;</span>unsigned char<span class="op">&gt;</span> <span class="op">&gt;</span>::data() <span class="ex">/usr/lib/gcc/x86_64-linux-gnu/8/../../../../include/c++/8/bits</span>/stl_vector.h:<span class="ex">1056</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co">#2456   NEW    cov: 4933 ft: 5042 corp: 9/55b lim: 21 exec/s: 0 rss: 160Mb L: 20/20 MS: 3 ChangeByte-InsertRepeatedBytes-PersAutoDict- DE: &quot;block&quot;-</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">#2467   NEW    cov: 4933 ft: 5043 corp: 10/76b lim: 21 exec/s: 0 rss: 161Mb L: 21/21 MS: 1 InsertByte-</span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">#4215   NEW    cov: 4941 ft: 5129 corp: 17/205b lim: 29 exec/s: 4215 rss: 350Mb L: 29/29 MS: 5 InsertByte-ChangeBit-CopyPart-InsertRepeatedBytes-CrossOver-</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="co">#4567   REDUCE cov: 4941 ft: 5129 corp: 17/204b lim: 29 exec/s: 4567 rss: 404Mb L: 24/29 MS: 2 ChangeByte-EraseBytes-</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="co">#6642   NEW    cov: 4941 ft: 5138 corp: 18/244b lim: 43 exec/s: 2214 rss: 450Mb L: 43/43 MS: 3 CopyPart-CMP-CrossOver- DE: &quot;verack&quot;-</span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="co"># abort fuzzing using ctrl-c</span></a>
<a class="sourceLine" id="cb2-30" title="30">$ <span class="fu">ls</span> process_message-seeded-from-thin-air/</a>
<a class="sourceLine" id="cb2-31" title="31"><span class="ex">349ac589fc66a09abc0b72bb4ae445a7a19e2cd8</span> 4df479f1f421f2ea64b383cd4919a272604087a7</a>
<a class="sourceLine" id="cb2-32" title="32"><span class="ex">a640312c98dcc55d6744730c33e41c5168c55f09</span> b135de16e4709558c0797c15f86046d31c5d86d7</a>
<a class="sourceLine" id="cb2-33" title="33"><span class="ex">c000f7b41b05139de8b63f4cbf7d1ad4c6e2aa7f</span> fc52cc00ec1eb1c08470e69f809ae4993fa70082</a>
<a class="sourceLine" id="cb2-34" title="34">$ <span class="fu">cat</span> --show-nonprinting process_message-seeded-from-thin-air/349ac589fc66a09abc0b72bb4ae445a7a19e2cd8</a>
<a class="sourceLine" id="cb2-35" title="35"><span class="ex">block</span>^@M-^?M-^?M-^?M-^?M-^?nM-^?M-^?</a></code></pre></div>
<p>In this case the fuzzer managed to create a <code>block</code> message which when passed to <code>ProcessMessage(...)</code> increased coverage.</p>
<p>The project's collection of seed corpora is found in the <a href="https://github.com/bitcoin-core/qa-assets"><code>bitcoin-core/qa-assets</code></a> repo.</p>
<p>To fuzz <code>process_message</code> using the <a href="https://github.com/bitcoin-core/qa-assets"><code>bitcoin-core/qa-assets</code></a> seed corpus:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1">$ <span class="fu">git</span> clone https://github.com/bitcoin-core/qa-assets</a>
<a class="sourceLine" id="cb3-2" title="2">$ <span class="ex">src/test/fuzz/process_message</span> qa-assets/fuzz_seed_corpus/process_message/</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="ex">INFO</span>: Seed: 1346407872</a>
<a class="sourceLine" id="cb3-4" title="4"><span class="ex">INFO</span>: Loaded 1 modules   (424174 inline 8-bit counters)<span class="bu">:</span> 424174 [0x55d8a9004ab8, 0x55d8a906c3a6),</a>
<a class="sourceLine" id="cb3-5" title="5"><span class="ex">INFO</span>: Loaded 1 PC tables (424174 PCs)<span class="bu">:</span> 424174 [0x55d8a906c3a8,0x55d8a96e5288),</a>
<a class="sourceLine" id="cb3-6" title="6"><span class="ex">INFO</span>:      991 files found in qa-assets/fuzz_seed_corpus/process_message/</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="ex">INFO</span>: -max_len is not provided<span class="kw">;</span> <span class="ex">libFuzzer</span> will not generate inputs larger than 4096 bytes</a>
<a class="sourceLine" id="cb3-8" title="8"><span class="ex">INFO</span>: seed corpus: files: 991 min: 1b max: 1858b total: 288291b rss: 150Mb</a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#993    INITED cov: 7063 ft: 8236 corp: 25/3821b exec/s: 0 rss: 181Mb</span></a>
<a class="sourceLine" id="cb3-10" title="10">â€¦</a></code></pre></div>
<p>If you find coverage increasing inputs when fuzzing you are highly encouraged to submit them for inclusion in the <a href="https://github.com/bitcoin-core/qa-assets"><code>bitcoin-core/qa-assets</code></a> repo.</p>
<p>Every single pull request submitted against the Bitcoin Core repo is automatically tested against all inputs in the <a href="https://github.com/bitcoin-core/qa-assets"><code>bitcoin-core/qa-assets</code></a> repo. Contributing new coverage increasing inputs is an easy way to help make Bitcoin Core more robust.</p>
<h2 id="macos-hints-for-libfuzzer">macOS hints for libFuzzer</h2>
<p>The default Clang/LLVM version supplied by Apple on macOS does not include fuzzing libraries, so macOS users will need to install a full version, for example using <code>brew install llvm</code>.</p>
<p>Should you run into problems with the address sanitizer, it is possible you may need to run <code>./configure</code> with <code>--disable-asm</code> to avoid errors with certain assembly code from Bitcoin Core's code. See <a href="https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.html#sanitizers">developer notes on sanitizers</a> for more information.</p>
<p>You may also need to take care of giving the correct path for <code>clang</code> and <code>clang++</code>, like <code>CC=/path/to/clang CXX=/path/to/clang++</code> if the non-systems <code>clang</code> does not come first in your path.</p>
<p>Full configure that was tested on macOS Catalina with <code>brew</code> installed <code>llvm</code>:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="ex">./configure</span> --enable-fuzz --with-sanitizers=fuzzer,address,undefined CC=/usr/local/opt/llvm/bin/clang CXX=/usr/local/opt/llvm/bin/clang++ --disable-asm</a></code></pre></div>
<p>Read the <a href="https://llvm.org/docs/LibFuzzer.html">libFuzzer documentation</a> for more information. This <a href="https://github.com/google/fuzzing/blob/master/tutorial/libFuzzerTutorial.html">libFuzzer tutorial</a> might also be of interest.</p>
<h1 id="fuzzing-bitcoin-core-using-american-fuzzy-lop-afl-fuzz">Fuzzing Bitcoin Core using american fuzzy lop (<code>afl-fuzz</code>)</h1>
<h2 id="quickstart-guide-1">Quickstart guide</h2>
<p>To quickly get started fuzzing Bitcoin Core using <a href="https://github.com/google/afl"><code>afl-fuzz</code></a>:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1">$ <span class="fu">git</span> clone https://github.com/bitcoin/bitcoin</a>
<a class="sourceLine" id="cb5-2" title="2">$ <span class="bu">cd</span> bitcoin/</a>
<a class="sourceLine" id="cb5-3" title="3">$ <span class="fu">git</span> clone https://github.com/google/afl</a>
<a class="sourceLine" id="cb5-4" title="4">$ <span class="fu">make</span> -C afl/</a>
<a class="sourceLine" id="cb5-5" title="5">$ <span class="fu">make</span> -C afl/llvm_mode/</a>
<a class="sourceLine" id="cb5-6" title="6">$ <span class="ex">./autogen.sh</span></a>
<a class="sourceLine" id="cb5-7" title="7">$ <span class="va">CC=$(</span><span class="bu">pwd</span><span class="va">)</span>/afl/afl-clang-fast <span class="va">CXX=$(</span><span class="bu">pwd</span><span class="va">)</span>/afl/afl-clang-fast++ <span class="ex">./configure</span> --enable-fuzz</a>
<a class="sourceLine" id="cb5-8" title="8">$ <span class="fu">make</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co"># For macOS you may need to ignore x86 compilation checks when running &quot;make&quot;. If so,</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co"># try compiling using: AFL_NO_X86=1 make</span></a>
<a class="sourceLine" id="cb5-11" title="11">$ <span class="fu">mkdir</span> -p inputs/ outputs/</a>
<a class="sourceLine" id="cb5-12" title="12">$ <span class="bu">echo</span> A <span class="op">&gt;</span> inputs/thin-air-input</a>
<a class="sourceLine" id="cb5-13" title="13">$ <span class="ex">afl/afl-fuzz</span> -i inputs/ -o outputs/ -- src/test/fuzz/bech32</a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co"># You may have to change a few kernel parameters to test optimally - afl-fuzz</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co"># will print an error and suggestion if so.</span></a></code></pre></div>
<p>Read the <a href="https://github.com/google/afl"><code>afl-fuzz</code> documentation</a> for more information.</p>
</body>
</html>
